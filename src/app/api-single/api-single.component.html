<div>
  <mat-spinner
    [diameter]="70"
    style="margin: auto"
    *ngIf="!service"
  ></mat-spinner>
</div>
<div *ngIf="service" style="margin: auto">
  <mat-card style="margin-top: 0em; padding-top: 0em" class="mat-card-flat">
    <mat-card-title fxLayout="row" style="align-items: center">
      <div>
        <!-- <mat-icon style="color: green; vertical-align: middle;"
            >fiber_manual_record</mat-icon
          >-->
        {{ serviceName | title }} &nbsp;
      </div>
    </mat-card-title>

    <mat-tab-group
      animationDuration="0ms"
      [selectedIndex]="selected"
      (selectedIndexChange)="tabChange($event)"
    >
      <mat-tab
        style="padding-top: 1em"
        label="Readme"
        *ngIf="service.service.endpoints"
      >
        <br />
        <div
          fxLayout="row wrap"
          style="padding-bottom: 1em; padding-right: 1px"
          fxLayoutAlign="space-between"
        >
          <div fxFlex="70%">
            <div *ngFor="let path of openAPI.paths | keyvalue">
              <h2>
                <span class="endpoint">{{ path.key }}</span>
              </h2>
              <div>
                <h3>{{ pathToRequestSchema(path.key)['title'] }}</h3>
                <table class="params">
                  <tr>
                    <th>Fieldname</th>
                    <th>Type</th>
                  </tr>
                  <tr
                    *ngFor="
                      let property of pathToRequestSchema(path.key)[
                        'properties'
                      ] | keyvalue
                    "
                  >
                    <td>{{ property.key }}</td>
                    <td>{{ property.value['type'] }}</td>
                  </tr>
                </table>
                <br />
              </div>
            </div>
          </div>
          <mat-card fxFlex="28%">
            <markdown [data]="service.readme"></markdown>
          </mat-card>
        </div>
      </mat-tab>
      <mat-tab
        style="padding-top: 1em"
        label="Query"
        *ngIf="service.service.endpoints"
      >
        <br />
        <app-api-endpoints
          [serviceName]="service.service.name"
          [endpointQuery]="endpointQuery"
          [selectedVersion]="selectedVersion"
        ></app-api-endpoints>
      </mat-tab>
    </mat-tab-group>
  </mat-card>
</div>
